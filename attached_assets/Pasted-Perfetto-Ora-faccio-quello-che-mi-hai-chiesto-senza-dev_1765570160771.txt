Perfetto.
Ora faccio **quello che mi hai chiesto**, senza deviazioni:
**un documento di istruzioni completo, chiaro e operativo** da incollare **cosÃ¬ comâ€™Ã¨** ad **agent3 su Replit**.

Non Ã¨ una chiacchiera: Ã¨ un **brief tecnico-esecutivo**.

---

# ğŸ“˜ ISTRUZIONI PER AGENT3 (REPLIT)

## Progetto: **LeadFlow â€“ App di Raccolta Email B2B Locali**

### ğŸ¯ OBIETTIVO

Costruire una **web app con interfaccia semplice** che permetta a un utente non tecnico di:

1. Cercare attivitÃ  commerciali (es. ristoranti) per **cittÃ  + categoria**
2. Estrarre **email reali** dai loro siti web
3. Gestire una **lista contatti**
4. Inviare email tramite **Mailjet**
5. Fare tutto **da unâ€™unica interfaccia**, senza usare direttamente Apify o Mailjet

---

## ğŸ§  CONCETTO CHIAVE

Lâ€™app **non fa scraping diretto**:
ğŸ‘‰ usa **API ufficiali** (Apify + Mailjet)

Lâ€™app Ã¨ un **orchestratore**:

* UI semplice
* backend che chiama servizi esterni
* stato chiaro (progress, errori, risultati)

---

## ğŸ§± ARCHITETTURA

### Frontend

* **React + Vite** (oppure Next.js se preferisci)
* UI minimal (shadcn/ui o MUI)
* 3 schermate principali

### Backend

* **Node.js (Express o Fastify)**
* API REST
* Gestione job asincroni

### Servizi esterni

* **Apify API**
* **Mailjet API**
* Database leggero (SQLite / Supabase / JSON locale per MVP)

---

## ğŸ” VARIABILI Dâ€™AMBIENTE (OBBLIGATORIE)

```
APIFY_API_TOKEN=
MAILJET_API_KEY=
MAILJET_API_SECRET=
```

---

## ğŸ–¥ï¸ STRUTTURA UI (OBBLIGATORIA)

### 1ï¸âƒ£ Schermata â€“ Raccolta Lead

Campi input:

* CittÃ  (string)
* Categoria (string, es: ristorante / pizzeria / bar)
* Bottone: **â€œAvvia ricercaâ€**

UI feedback:

* Stato:

  * â€œCerco attivitÃ  su Google Mapsâ€¦â€
  * â€œAnalizzo siti webâ€¦â€
  * â€œEmail trovate: Xâ€

---

### 2ï¸âƒ£ Schermata â€“ Lista Contatti

Tabella con colonne:

* Nome attivitÃ 
* Sito web
* Email trovata
* Fonte (sito / facebook / contatti)
* Checkbox (seleziona / escludi)

Funzioni:

* Rimuovi duplicati
* Esporta CSV
* Seleziona per invio

---

### 3ï¸âƒ£ Schermata â€“ Invio Email

Campi:

* Email mittente (es: [newsletter@nonsolomenu.app](mailto:newsletter@nonsolomenu.app))
* Oggetto
* Corpo email (HTML o testo)
* Bottone: **Invia test**
* Bottone: **Invia campagna**

---

## âš™ï¸ FLUSSO TECNICO (PASSO PER PASSO)

### STEP 1 â€“ Raccolta attivitÃ 

Usare **Apify â€“ Google Maps Scraper**

Input:

* query: `"ristoranti ${cittÃ }"`
* country: IT
* max results configurabile

Output richiesto:

* nome attivitÃ 
* sito web (se presente)
* telefono
* indirizzo

---

### STEP 2 â€“ Estrazione email

Per ogni sito web trovato:

Usare **Apify â€“ Website Content Crawler**

* visita homepage + /contatti + /contact
* regex per email:

  ```
  [a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-z]{2,}
  ```

Filtri:

* escludere:

  * noreply@
  * no-reply@
  * example@
* preferire:

  * info@
  * contatti@
  * booking@
  * amministrazione@

---

### STEP 3 â€“ Normalizzazione dati

Ogni contatto deve avere **minimo**:

* email
* nome attivitÃ  (come â€œNomeâ€)
* cognome = â€œTitolareâ€ (fallback)

âš ï¸ NON inventare date di nascita reali
Usare campi minimi per compatibilitÃ  Mailjet

---

### STEP 4 â€“ Gestione lista

Salvare i contatti in DB locale con:

* status: new / selected / sent
* fonte
* timestamp

---

### STEP 5 â€“ Invio email (Mailjet)

Usare Mailjet API per:

* creare lista
* importare contatti
* inviare email

Supportare:

* invio test (1 email)
* invio batch

---

## âš ï¸ VINCOLI IMPORTANTI

* âŒ NON fare scraping diretto senza Apify
* âŒ NON inventare email
* âŒ NON inviare email senza consenso visibile (footer + unsubscribe)
* âœ… Gestire errori API (timeout, quota, nessun sito)

---

## ğŸ“ STRUTTURA PROGETTO (SUGGERITA)

```
/frontend
  /pages
  /components
/backend
  /routes
  /services
    apify.js
    mailjet.js
  /jobs
  server.js
```

---

## ğŸš€ OBIETTIVO MVP

Lâ€™MVP Ã¨ **completo** se:

* inserisco â€œRoma + Ristorantiâ€
* ottengo una lista email reali
* invio una mail di test
* tutto senza uscire dallâ€™app

---

## ğŸ§­ NOTA FINALE PER AGENT3

Questa app **non Ã¨ un esercizio**.
Ãˆ un **prodotto reale**, pensato per:

* PMI
* agenzie
* progetti come Pantheon Business

Scrivi codice **pulito**, leggibile, modulare.
Privilegia **funzionamento e chiarezza** rispetto allâ€™estetica.

---

Se vuoi, nel prossimo messaggio posso:

* adattare il testo **esattamente** allo stile che agent3 preferisce
* oppure scrivere **anche i prompt interni** per le singole funzioni (Apify, Mailjet, UI)

Dimmi solo: **procediamo o rifiniamo ancora 5%?**
